function setDesiredGroup(g){ activeGroup=g; renderDesiredTabs(); renderDesiredPills(); refreshMatches(); }
function renderDesiredPills(){
  const items=impactSort(MOOD_GROUPS_BASE[activeGroup]);
  $('#desiredPills').innerHTML = items.map(n=>`<button class="pill ${state.desired.has(n)?'on':''}" onclick="toggleDesired('${n}')">${n}</button>`).join('');
}
function toggleDesired(n){ if(state.desired.has(n)) state.desired.delete(n); else state.desired.add(n); renderDesiredPills(); refreshMatches(); }

/* ---------- DISCOVER: scoring + chips + swipe ---------- */

const SHOW_PACE = false;          // set true if you want â± pace shown
const CHIP_MAX   = 6;             // how many chips before we show â€œ+ moreâ€

function score(b){
  const inter = (arr,set)=>arr.filter(x=>set.has(x)).length;
  let s = inter(b.vibes||[], state.desired) * 1.4;
  if (state.moodNowLevel === 'Low')  s += 0.2;
  if (state.moodNowLevel === 'High') s += 0.1;
  if (b.gold) s += 2.5;
  return s;
}

function pickChips(b){
  const chips = [];

  // Primary â€œfeelâ€ chips first (what users latch onto)
  if (Array.isArray(b.vibes)) chips.push(...b.vibes);

  // Book facts (compact & readable)
  if (SHOW_PACE && b?.facts?.pace)  chips.push(`â± ${b.facts.pace}`);
  if (b?.facts?.pages)              chips.push(`ğŸ“„ ${b.facts.pages}p`);
  if (b?.facts?.year)               chips.push(`ğŸ“… since ${b.facts.year}`);

  // Optional tags youâ€™ve added to the book
  i

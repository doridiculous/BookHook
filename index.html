<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BookHook</title>

<!-- ===== Base Styles (shared) ===== -->
<style>
:root{
  --bg:#f7f7f8; --fg:#111; --muted:#6b7280;
  --card:#fff; --line:#e5e7eb; --pill:#f5f5f5;
  --accent:#000; --accentfg:#fff; --gold:#E7C200;
}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;background:var(--bg);color:var(--fg);
  font:16px/1.5 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif}
.wrap{max-width:980px;margin:0 auto;padding:18px 14px}
.card{background:var(--card);border:1px solid var(--line);border-radius:14px;
  padding:16px;margin:12px 0;box-shadow:0 1px 8px rgba(0,0,0,.03)}
h1,h2{margin:0 0 10px} .muted{color:var(--muted);font-size:14px}
.btn{padding:10px 14px;border-radius:999px;border:1px solid var(--line);background:#fff;cursor:pointer;font-weight:600}
.btn.small{font-size:12px;padding:6px 10px}
.btn.gold{background:var(--gold);border-color:#caa900;color:#000}
.badge{padding:4px 10px;border-radius:999px;border:1px solid var(--line);background:#fff;font-weight:600;font-size:12px}
.badge.gold{background:#fff7cc;border-color:#E7C200}
.row{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin:8px 0}
.lbl{min-width:100px;color:var(--muted)}
.field{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:10px;background:#fff;font:inherit}
.pills{display:flex;flex-wrap:wrap;gap:8px}
.pill{padding:8px 12px;border:1px solid var(--line);border-radius:999px;background:var(--pill);cursor:pointer}
.pill.on{background:#111;color:#fff;border-color:#111}
.divider{height:1px;background:var(--line);margin:12px 0}

/* ===== Component: Top Nav ===== */
.bar{display:flex;justify-content:space-between;align-items:center;padding:10px 14px;background:#fff;border-bottom:1px solid var(--line);position:sticky;top:0;z-index:3}
.nav{display:flex;gap:8px;flex-wrap:wrap}

/* ===== Component: Hero (logo + name) ===== */
.hero{display:flex;flex-direction:column;align-items:center;gap:8px;padding:22px 12px}
.logo{height:56px}
.logo-text{font-weight:800;text-align:center}

/* ===== Component: Discover (swipe) ===== */
.swipe{display:grid;grid-template-columns:210px 1fr;gap:16px}
@media (max-width:740px){.swipe{grid-template-columns:1fr}}
.cover{width:100%;aspect-ratio:2/3;border-radius:12px;overflow:hidden;background:#e5e7eb;
  display:flex;align-items:center;justify-content:center;font-weight:800;font-size:48px}
.cover img{width:100%;height:100%;object-fit:cover;display:block}
.chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px;align-items:center}
.chip{display:inline-flex;white-space:nowrap;padding:6px 10px;border:1px solid var(--line);
  border-radius:999px;background:#fafafa;font-size:13px}
.chips .chip:nth-of-type(n+7){display:none} .chips .chip.more{display:inline-flex !important}
.hint{background:#fff7cc;border:1px solid #E7C200;padding:6px 10px;border-radius:999px;font-weight:600;font-size:12px}
.card-gesture{position:relative;touch-action:pan-y;user-select:none;will-change:transform}
.badge-swipe{position:absolute;top:10px;padding:6px 10px;border-radius:8px;font-weight:700;border:2px solid;background:rgba(255,255,255,.9);opacity:0;transition:opacity .15s}
.badge-swipe.like{left:10px;color:#0a6a0a;border-color:#0a6a0a}
.badge-swipe.nope{right:10px;color:#cc1b1b;border-color:#cc1b1b}

/* ===== Component: Shelf / HookMarks list tiles ===== */
.list{display:flex;flex-direction:column;gap:10px}
.tile{display:grid;grid-template-columns:64px 1fr auto;gap:12px;align-items:center;padding:10px;border:1px solid var(--line);border-radius:12px;background:#fff}
.tile .thumb{width:64px;height:96px;border-radius:8px;background:#eee;overflow:hidden}
.thumb img{width:100%;height:100%;object-fit:cover}
.stat{padding:4px 8px;border-radius:999px;border:1px solid var(--line);background:#f6f6f6;font-size:12px}
.stat.want{background:#eef3ff;border-color:#cfe1ff}
.stat.reading{background:#eaf8ed;border-color:#b8e4c3}
.stat.read{background:#fff0d2;border-color:#f7dc8a}

/* ===== Component: Modal ===== */
.modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,.45);padding:20px;z-index:10}
.modal .box{background:#fff;border-radius:14px;border:1px solid var(--line);max-width:560px;width:100%;padding:16px}
.modal.show{display:flex}

/* ===== Footer ===== */
footer{padding:28px 14px;text-align:center;color:#666}
</style>
</head>

<body>
<main class="wrap">

<!-- =========================================================
     SECTION 1 — TOP NAV  (move entire section to reorder)
========================================================= -->
<section class="card" id="navSection">
  <header class="bar">
    <div class="nav">
      <button class="btn small" onclick="scrollToId('discoverSection')">Discover</button>
      <button class="btn small" onclick="scrollToId('hookMarksSection')">HookMarks</button>
      <button class="btn small" onclick="scrollToId('profileSection')">My Profile</button>
      <button class="btn small" onclick="scrollToId('boardsSection')">Leaderboards</button>
    </div>
    <div class="status"><span class="badge">Bronze</span><span id="pts" class="badge gold">0 pts</span></div>
  </header>
</section>

<!-- =========================================================
     SECTION 2 — HERO (centered logo + name)
========================================================= -->
<section class="card hero" id="heroSection" style="text-align:center">
  <!-- Simple black book logo (inline SVG, no upload needed) -->
  <svg class="logo" viewBox="0 0 64 64" width="56" height="56" aria-label="BookHook">
    <rect x="8" y="8" width="48" height="48" rx="8" fill="#000"/>
    <rect x="14" y="12" width="3" height="40" rx="1.5" fill="#fff"/>
  </svg>
  <div class="logo-text">BookHook</div>
</section>

<!-- =========================================================
     SECTION 3 — FEELING BAR (free text + level)
========================================================= -->
<section class="card" id="feelingSection">
  <h2>How I’m feeling</h2>
  <div class="row">
    <input id="moodFree" class="field" placeholder="I am feeling … (tired, anxious, pumped…)" />
    <button id="setMoodFree" class="btn small">Set</button>
  </div>
  <div class="row">
    <span class="lbl">Level:</span>
    <div class="pills">
      <button class="pill" onclick="setLevel('Low')">Low</button>
      <button class="pill" onclick="setLevel('Medium')">Medium</button>
      <button class="pill" onclick="setLevel('High')">High</button>
    </div>
  </div>
  <div class="muted">Type anything (“overwhelmed”, “hyped”) or tap a level. This nudges your matches.</div>
</section>

<!-- =========================================================
     SECTION 4 — DESIRED MOOD (categorized + Entrepreneurial)
========================================================= -->
<section class="card" id="desiredSection">
  <h2>Desired Mood</h2>
  <div class="row" id="desiredTabs"></div>
  <div class="pills" id="desiredPills"></div>
  <div class="muted">Choose a few — these steer the match score below.</div>
</section>

<!-- =========================================================
     SECTION 5 — DISCOVER (swipe; carousel; horizontal chips)
========================================================= -->
<section class="card" id="discoverSection">
  <h2>Discover</h2>
  <div class="muted" style="margin:-4px 0 10px">
    Swipe left: Want • Swipe right: Reading • Tap “Already read” to add HookMarks
  </div>
  <div id="swipe" class="swipe"></div>
</section>

<!-- =========================================================
     SECTION 6 — YOUR SHELF (mini list)
========================================================= -->
<section class="card" id="shelfSection">
  <h2>Your Shelf</h2>
  <div class="muted">Save or swipe to add books. Full list is in <a href="#profile" onclick="scrollToId('profileSection')">My Profile</a>.</div>
  <div id="shelfList" class="list"></div>
</section>

<!-- =========================================================
     SECTION 7 — HOOKMARKS (all reader notes)
========================================================= -->
<section class="card" id="hookMarksSection">
  <h2>HookMarks</h2>
  <div class="row">
    <select id="hmFilter" class="field" style="max-width:260px">
      <option value="">All</option>
      <option value="lol">LOL</option>
      <option value="aha">Aha</option>
      <option value="brk">Breakthrough</option>
    </select>
    <button class="btn small" onclick="renderHookMarks()">Filter</button>
    <button class="btn small" onclick="document.getElementById('hmFilter').value='';renderHookMarks()">Clear</button>
  </div>
  <div id="hookList" class="list"></div>
</section>

<!-- HOOKMARKS modal -->
<div id="hmModal" class="modal" role="dialog" aria-modal="true" aria-label="Add HookMark">
  <div class="box">
    <h3 id="hmTitle">Add HookMark</h3>
    <div class="row"><span class="lbl">Mood before:</span>
      <div class="pills"><button class="pill" onclick="hmSet('before','Low')">Low</button><button class="pill" onclick="hmSet('before','Medium')">Medium</button><button class="pill" onclick="hmSet('before','High')">High</button></div>
    </div>
    <div class="row"><span class="lbl">Mood after:</span>
      <div class="pills"><button class="pill" onclick="hmSet('after','Low')">Low</button><button class="pill" onclick="hmSet('after','Medium')">Medium</button><button class="pill" onclick="hmSet('after','High')">High</button></div>
    </div>
    <div class="row"><span class="lbl">What sparked?</span>
      <label class="pill"><input type="checkbox" id="hmLol" /> LOL</label>
      <label class="pill"><input type="checkbox" id="hmAha" /> Aha</label>
      <label class="pill"><input type="checkbox" id="hmBrk" /> Breakthrough</label>
    </div>
    <textarea id="hmNote" class="field" rows="3" placeholder="What changed for you? (optional)"></textarea>
    <div class="row" style="justify-content:flex-end;gap:8px">
      <button class="btn" onclick="closeHM()">Cancel</button>
      <button class="btn gold" onclick="saveHM()">Save</button>
    </div>
  </div>
</div>

<!-- =========================================================
     SECTION 8 — MY PROFILE (role, points, counts)
========================================================= -->
<section class="card" id="profileSection">
  <h2>My Profile</h2>
  <div class="row"><span class="lbl">Role:</span>
    <label class="pill"><input type="checkbox" id="isReader" checked /> Reader</label>
    <label class="pill"><input type="checkbox" id="isAuthor" /> Author</label>
  </div>
  <div class="row"><span class="lbl">Points:</span> <b id="profilePts">0</b></div>
  <div class="row"><span class="lbl">HookMarks:</span> <b id="profileHooks">0</b></div>
</section>

<!-- =========================================================
     SECTION 9 — LEADERBOARDS
========================================================= -->
<section class="card" id="boardsSection">
  <h2>Leaderboards</h2>
  <div id="boardsWrap" class="list"></div>
</section>

<!-- =========================================================
     SECTION 10 — FOOTER TAGLINE (bottom)
========================================================= -->
<footer id="footerSection">Dream Big • Do Ridiculous • Achieve Remarkable</footer>

</main>

<!-- ===== Inline Logic ===== -->
<script>
/*************** State & Data ***************/
const state = {
  moodNowLevel:null,
  desired:new Set(),
  pts:Number(localStorage.getItem('bh_pts')||0),
  shelf: JSON.parse(localStorage.getItem('bh_shelf')||"[]"),
  hookmarks: JSON.parse(localStorage.getItem('bh_hooks')||"[]"),
  impact: JSON.parse(localStorage.getItem('bh_impact')||"{}"),
  order:[], activeBook:null
};
const MOOD_GROUPS_BASE={
  "Calm / Steady":["Calm","Restful","Reflective","Grounding","Peaceful","Soothing"],
  "Clarity":["Clear-headed","Focused","Insightful","Mindset-shifting"],
  "Drive":["Motivated","Empowered","Productive","Entrepreneurial"],
  "Spark / Fun":["Playful","Silly","Comedic","Uplifting","Inspiring","Arousing"],
  "Comfort & Care":["Comforted","Self-loving","Grateful","Connected"]
};
const MOOD_MAP={
  low:["sad","down","tired","drained","anxious","overwhelmed","lonely","stressed","meh"],
  medium:["ok","fine","neutral","calm","grounded","chill","steady"],
  high:["happy","joyful","excited","energized","pumped","hyped","curious","inspired","motivated"]
};
const BOOKS=[
  {id:"rid",title:"The Ridiculous: Book 1",author:"Jef & Mindy",
   vibes:["Funny","Satirical","Empowering","Chill","Feel-good"],facts:{pace:"Medium",pages:312,year:2024},gold:true,links:{site:"#",buy:"#"}},
  {id:"mag",title:"Magical Adventures of Lori & Bonnie B. Bunny",author:"Elaine Blackstien",
   vibes:["Inspiring","Playful","Comedic","Uplifting","Fast"],facts:{pace:"Fast",pages:248,year:2025},links:{buy:"#"}},
  {id:"hab",title:"Atomic Habits of the Heart",author:"A. North",
   vibes:["Focused","Grounded","Practical","Motivated","Calm"],facts:{pace:"Fast",pages:280,year:2019},links:{buy:"#"}},
  {id:"coz",title:"Star Soup & Cozy Skies",author:"L. Nova",
   vibes:["Calm","Cozy","Comforted","Reflective"],facts:{pace:"Slow",pages:220,year:2021},links:{buy:"#"}}
];

/*************** Helpers ***************/
const $=s=>document.querySelector(s);
function scrollToId(id){ document.getElementById(id)?.scrollIntoView({behavior:'smooth',block:'start'}); }
function escapeHtml(s){return String(s||'').replace(/[&<>"']/g,m=>({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"}[m]))}
function addPts(n){ state.pts+=n; localStorage.setItem('bh_pts',state.pts); $('#pts').textContent=state.pts+' pts'; $('#profilePts').textContent=state.pts; }
function levelToNum(v){ return v==='High'?3:(v==='Low'?1:2); }

/*************** Feeling ***************/
document.getElementById('setMoodFree').addEventListener('click',()=>mapFreeMood($('#moodFree').value));
function setLevel(v){ state.moodNowLevel=v; refreshMatches(); }
function mapFreeMood(text){
  const t=(text||'').toLowerCase().trim(); if(!t) return;
  const hit=a=>a.some(w=>t.includes(w));
  if(hit(MOOD_MAP.high)) state.moodNowLevel='High';
  else if(hit(MOOD_MAP.low)) state.moodNowLevel='Low';
  else state.moodNowLevel='Medium';
  refreshMatches();
}

/*************** Desired Mood (tabs + pills) ***************/
let activeGroup=Object.keys(MOOD_GROUPS_BASE)[0];
function impactSort(arr){ return [...arr].sort((a,b)=>(state.impact[b]||0)-(state.impact[a]||0)); }
function renderDesiredTabs(){
  $('#desiredTabs').innerHTML = Object.keys(MOOD_GROUPS_BASE).map(g =>
    `<button class="pill ${g===activeGroup?'on':''}" onclick="setDesiredGroup('${g}')">${g}</button>`).join('');
}
function setDesiredGroup(g){ activeGroup=g; renderDesiredTabs(); renderDesiredPills(); refreshMatches(); }
function renderDesiredPills(){
  const items=impactSort(MOOD_GROUPS_BASE[activeGroup]);
  $('#desiredPills').innerHTML = items.map(n=>`<button class="pill ${state.desired.has(n)?'on':''}" onclick="toggleDesired('${n}')">${n}</button>`).join('');
}
function toggleDesired(n){ if(state.desired.has(n)) state.desired.delete(n); else state.desired.add(n); renderDesiredPills(); refreshMatches(); }

/*************** Discover (covers + swipe) ***************/
async function prefetchCovers(){
  await Promise.all(BOOKS.map(async b=>{
    if(b.image){b._hasImg=true;return;}
    try{
      const q=encodeURIComponent(`intitle:${b.title} inauthor:${b.author}`);
      const res=await fetch(`https://www.googleapis.com/books/v1/volumes?q=${q}&maxResults=1`);
      if(res.ok){
        const data=await res.json();
        const img=data?.items?.[0]?.volumeInfo?.imageLinks?.thumbnail
               || data?.items?.[0]?.volumeInfo?.imageLinks?.smallThumbnail;
        if(img){ b.image=img.replace('http://','https://'); b._hasImg=true; }
      }
    }catch(e){}
    if(!b.image) b._skip=true;
  }));
}
function score(b){
  const inter=(arr,set)=>arr.filter(x=>set.has(x)).length;
  let s=inter(b.vibes||[],state.desired)*1.4;
  if(state.moodNowLevel==='Low') s+=0.2;
  if(state.moodNowLevel==='High') s+=0.1;
  if(b.gold) s+=2.5;
  return s;
}
function refreshMatches(){
  const pool=BOOKS.filter(b=>!b._skip);
  state.order=pool.sort((a,b)=>score(b)-score(a));
  show(0);
}
function show(idx){
  if(!state.order.length){ $('#swipe').innerHTML='<div class="muted">No books yet.</div>'; return; }
  const b=state.order[idx%state.order.length];
  const rawChips=[...(b.vibes||[]), b.facts?.pace, b.facts?.pages?`${b.facts.pages}p`:null, b.facts?.year?`Since ${b.facts.year}`:null].filter(Boolean);
  const max=6;
  const chipsHtml=rawChips.slice(0,max).map(c=>`<span class="chip">${escapeHtml(c)}</span>`).join('')+(rawChips.length>max?`<span class="chip more">+ ${rawChips.length-max} more</span>`:'');
  $('#swipe').innerHTML=`
    <div id="card" class="card-gesture swipe">
      <div class="cover">${b.image?`<img src="${b.image}" alt="Cover of ${escapeHtml(b.title)}">`:escapeHtml(b.title[0]||'?')}</div>
      <div>
        <div class="row" style="justify-content:space-between;align-items:center">
          <div>${b.gold?'<span class="badge gold">Featured</span>':''}</div>
          <div class="badge gold" id="ptsTop">${state.pts} pts</div>
        </div>
        <h2 style="margin:6px 0 4px">${escapeHtml(b.title)}</h2>
        <div class="muted">by ${escapeHtml(b.author)}</div>
        <div class="chips">${chipsHtml}</div>
        <div class="row" style="gap:8px;margin-top:10px">
          <button class="btn" onclick="markShelf('${b.id}','want')">Want (+5)</button>
          <button class="btn" onclick="markShelf('${b.id}','reading')">Reading (+7)</button>
          <button class="btn gold" onclick="startHookmark('${b.id}')">Already read</button>
        </div>
      </div>
      <span class="badge-swipe like">SAVE</span><span class="badge-swipe nope">NOPE</span>
    </div>`;
  addSwipe(document.getElementById('card'), ()=>markShelf(b.id,'want'), ()=>markShelf(b.id,'reading'));
}
function addSwipe(el,onLeft,onRight){
  let startX=0,dx=0,drag=false; const like=el.querySelector('.badge-swipe.like'),nope=el.querySelector('.badge-swipe.nope');
  const down=e=>{drag=true;startX=e.clientX??e.touches?.[0]?.clientX;el.style.transition='';};
  const move=e=>{if(!drag)return; const x=e.clientX??e.touches?.[0]?.clientX; dx=x-startX; el.style.transform=`translateX(${dx}px) rotate(${dx/12}deg)`; const a=Math.min(1,Math.abs(dx)/120); if(dx>0){like.style.opacity=a;nope.style.opacity=0;} else{nope.style.opacity=a;like.style.opacity=0;}};
  const snap=()=>{el.style.transition='transform .2s'; el.style.transform='translateX(0) rotate(0)'; like.style.opacity=0; nope.style.opacity=0;};
  const up=()=>{if(!drag)return; drag=false; if(dx>80){el.style.transition='transform .2s'; el.style.transform='translateX(500px) rotate(15deg)'; setTimeout(onRight,160);} else if(dx<-80){el.style.transition='transform .2s'; el.style.transform='translateX(-500px) rotate(-15deg)'; setTimeout(onLeft,160);} else snap();};
  el.addEventListener('pointerdown',down); el.addEventListener('pointermove',move); el.addEventListener('pointerup',up); el.addEventListener('pointercancel',up);
}

/*************** Shelf ***************/
function markShelf(id,status){
  const b=BOOKS.find(x=>x.id===id); if(!b) return;
  const ex=state.shelf.find(x=>x.id===id);
  if(ex){ex.status=status;} else {state.shelf.unshift({id:b.id,title:b.title,author:b.author,image:b.image,status});}
  localStorage.setItem('bh_shelf',JSON.stringify(state.shelf));
  addPts(status==='want'?5:7); renderShelf();
  state.order.push(state.order.shift()); show(0);
}
function renderShelf(){
  const box=$('#shelfList'); if(!box) return;
  if(!state.shelf.length){ box.innerHTML=''; return; }
  box.innerHTML=state.shelf.map(b=>`
    <div class="tile">
      <div class="thumb">${b.image?`<img src="${b.image}" alt="">`:''}</div>
      <div><div><b>${escapeHtml(b.title)}</b></div><div class="muted">by ${escapeHtml(b.author)}</div></div>
      <div class="stat ${b.status}">${b.status}</div>
    </div>`).join('');
}

/*************** HookMarks ***************/
function startHookmark(id){ const b=BOOKS.find(x=>x.id===id); if(!b) return; state.activeBook=b; $('#hmTitle').textContent=`Add HookMark — ${b.title}`; $('#hmNote').value=''; ['hmLol','hmAha','hmBrk'].forEach(k=>document.getElementById(k).checked=false); $('#hmModal').classList.add('show'); }
function closeHM(){ $('#hmModal').classList.remove('show'); state.hm_before=null; state.hm_after=null; }
function hmSet(which,val){ state['hm_'+which]=val; }
function saveHM(){
  const b=state.activeBook; if(!b) return;
  const entry={ id:String(Date.now()), bookId:b.id, ts:Date.now(),
    before:state.hm_before||'Medium', after:state.hm_after||'Medium',
    lol:document.getElementById('hmLol').checked?1:0,
    aha:document.getElementById('hmAha').checked?1:0,
    brk:document.getElementById('hmBrk').checked?1:0,
    note:document.getElementById('hmNote').value.trim()
  };
  state.hookmarks.unshift(entry);
  localStorage.setItem('bh_hooks',JSON.stringify(state.hookmarks));
  const delta=levelToNum(entry.after)-levelToNum(entry.before);
  if(delta>0){ state.desired.forEach(m=>{ state.impact[m]=(state.impact[m]||0)+delta; }); localStorage.setItem('bh_impact',JSON.stringify(state.impact)); }
  addPts(15); renderHookMarks(); closeHM();
}
function renderHookMarks(){
  const box=$('#hookList'); if(!box) return;
  const f=$('#hmFilter')?.value||'';
  const rows=state.hookmarks.filter(h=>!f||h[f]).map(h=>{
    const b=BOOKS.find(x=>x.id===h.bookId)||{};
    return `<div class="tile">
      <div class="thumb">${b.image?`<img src="${b.image}" alt="">`:''}</div>
      <div>
        <div><b>${escapeHtml(b.title||'Unknown')}</b> · <span class="muted">${new Date(h.ts).toLocaleDateString()}</span></div>
        <div class="chips"><span class="chip">Before: ${h.before}</span><span class="chip">After: ${h.after}</span>${h.lol?'<span class="chip">LOL</span>':''}${h.aha?'<span class="chip">Aha</span>':''}${h.brk?'<span class="chip">Breakthrough</span>':''}</div>
        ${h.note?`<div class="muted" style="margin-top:6px">${escapeHtml(h.note)}</div>`:''}
      </div><div></div></div>`;
  });
  box.innerHTML=rows.join('')||'<div class="muted">No HookMarks yet.</div>';
}

/*************** Boards ***************/
function rebuildBoards(){
  const map={};
  state.hookmarks.forEach(h=>{
    const b=BOOKS.find(x=>x.id===h.bookId); if(!b) return;
    const k=b.author; map[k]=map[k]||{lol:0,aha:0,brk:0}; map[k].lol+=h.lol; map[k].aha+=h.aha; map[k].brk+=h.brk;
  });
  const rows=Object.entries(map).map(([name,c])=>({name,score:c.lol+c.aha*2+c.brk*3,lol:c.lol,aha:c.aha,brk:c.brk})).sort((a,b)=>b.score-a.score);
  $('#boardsWrap').innerHTML=rows.map(r=>`
    <div class="tile"><div class="thumb"></div>
      <div><b>${escapeHtml(r.name)}</b><div class="muted">LOL ${r.lol} · Aha ${r.aha} · Breakthrough ${r.brk}</div></div>
      <div class="stat read">Score ${r.score}</div></div>`).join('')||'<div class="muted">No entries yet.</div>';
}

/*************** Boot ***************/
document.addEventListener('DOMContentLoaded', async ()=>{
  $('#pts').textContent=state.pts+' pts';
  $('#profilePts').textContent=state.pts;
  renderDesiredTabs(); renderDesiredPills();
  await prefetchCovers(); refreshMatches();
  renderShelf(); renderHookMarks(); rebuildBoards();
});
</script>
</body>
</html>
